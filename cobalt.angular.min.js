/*! cobalt-js - v0.7.1 - 2014-01-03 */
!function(){"use strict";angular.module("cb.directives",["cbSlider","cbTooltip","cbSelect","cbSelectReplace"]),angular.module("cb.utilities",["cb.directives"]),angular.module("cbSelect",[]).directive("cbSelect",["$compile","$filter","$timeout",function(a,b,c){return{restrict:"A",scope:{ngModel:"=",options:"="},template:'<div class="cb-select" tabindex="0"><div class="cb-select-value" ng-click="select.toggle()" ng-class="{active: select.show}" title="{{ select.selectedItem[labelKey] }}"><span>{{ select.selectedItem[labelKey] || placeholder }}</span><i></i></div><div class="cb-select-dropdown" ng-show="select.show"><div class="cb-select-options"><div class="cb-select-option" ng-repeat="option in select.options" ng-click="select.selectOption(option)" ng-class="{active: option == select.selectedItem}">{{ option[labelKey] }}</div></div><select ng-hide="true"><option ng-repeat="o in select.options" value="{{ o[valueKey] }}" ng-selected="o[valueKey] == select.selectedItem[valueKey]">{{ o[labelKey] }}</option></select></div></div>',replace:!0,link:function(d,e,f){var g,h,i,j,k,l=-1;h={placeholder:"Select a value",labelKey:"label",valueKey:"value",search:!1},angular.extend(h,d.$eval(f.cbSelect)),d.valueKey=h.valueKey,d.labelKey=h.labelKey,d.placeholder=h.placeholder,h.search&&e.find(".cb-select-dropdown").prepend(a('<div class="cb-select-search"><input type="text" ng-model="select.search"/></div>')(d)),g=d.options,i=d.select={show:!1,focused:!1,options:g,selectedItem:null,selectOption:function(a){l=jQuery.inArray(a,g),i.selectedItem=a,i.close()},toggle:function(){i.show=!i.show},open:function(){i.show=!0},close:function(){i.show=!1},scrollIntoView:function(){var a,b;a=e.find(".cb-select-options"),b=e.find(".cb-select-option").eq(l),b.position().top+b.outerHeight()>a.height()?a.scrollTop(a.scrollTop()+b.outerHeight()+b.position().top-a.height()):b.position().top<0&&a.scrollTop(a.scrollTop()+b.position().top)},nextOption:function(){l<g.length-1&&(i.selectedItem=i.options[++l],i.scrollIntoView())},prevOption:function(){l>0&&(i.selectedItem=i.options[--l],i.scrollIntoView())},keypress:function(a){40===a.keyCode?i.nextOption():38===a.keyCode?i.prevOption():13===a.keyCode?i.toggle():h.search&&/^[a-z0-9]+$/i.test(String.fromCharCode(a.keyCode))&&a.target!==j.get(0)&&(i.open(),c(function(){j.focus(),i.search=String.fromCharCode(a.keyCode).toLowerCase()},15))}},d.$watch("select.search",function(a){if(!a)return i.selectedItem=null,void 0;i.options=b("filter")(g,a);var d=i.options.indexOf(i.selectedItem);d>-1?(i.selectedItem=i.options[l=d],i.show&&c(function(){i.scrollIntoView()},10)):i.selectedItem=i.options[l=0]}),d.$watch("select.selectedItem",function(a){a&&(d.ngModel=a)}),j=e.find(".cb-select-search>input"),k=e.find(".cb-select-option"),e.on("click",".cb-select-value",function(){e.trigger("focus")}),e.on("focusout",function(a){(j.length>0?a.relatedTarget===j.get(0):0)||d.$apply(function(){i.focused=!1,i.close()})}),j.on("focusout",function(){d.$apply(function(){i.focused=!1,i.close()})}),e.on("keydown",function(a){[38,40].indexOf(a.keyCode)>0&&a.preventDefault(),d.$apply(function(){i.keypress(a)})})}}}]),angular.module("cbSelectReplace",[]).directive("cbSelectReplace",["$compile","$rootScope","$filter","$timeout",function(a,b,c,d){return{restrict:"CA",scope:!0,require:"?ngModel",compile:function(a,e){var f,g,h,i,j,k=[],l=0;return j=b.$eval(e.cbSelectReplace)||{},g="select"===a.get(0).nodeName.toLowerCase()?a:a.find("select"),h=g.attr("name")||"",i=g.attr("tabindex")||0,f='<div class="cb-select" tabindex="'+i+'"><div class="cb-select-value" ng-click="select.toggle()" ng-class="{active: select.show}" title="{{ select.selectedItem.label }}"><span>{{ select.selectedItem.label }}</span><i></i></div><div class="cb-select-dropdown" ng-show="select.show">'+(j.search?'<div class="cb-select-search"><input type="text" ng-model="select.search"/></div>':"")+'<div class="cb-select-options"><div class="cb-select-option" ng-repeat="option in select.options" ng-mousedown="select.selectOption(option)" ng-class="{active: option == select.selectedItem}">{{ option.label }}</div></div><select ng-hide="true" name="'+h+'"><option ng-repeat="o in select.options" value="{{ o.value }}" ng-selected="o.value == select.selectedItem.value">{{ o.label }}</option></select></div></div>',angular.forEach(g.find("option"),function(a,b){a=angular.element(a),k.push({label:a.text(),value:a.val()}),"selected"===a.attr("selected")&&(l=b)}),g.replaceWith(angular.element(f)),{pre:function(a,b,e,f){var g,h,i,m=l;g=a.select={show:!1,focused:!1,options:k,selectedItem:k[l],selectOption:function(a){m=jQuery.inArray(a,k),g.selectedItem=a,g.close()},toggle:function(){g.show?g.close():g.open()},open:function(){g.show=!0,d(function(){g.scrollIntoView()},15)},close:function(){g.show=!1,g.search=""},scrollIntoView:function(){var a,c;a=b.find(".cb-select-options"),c=b.find(".cb-select-option").eq(m),c.position().top+c.outerHeight()>a.height()?a.scrollTop(a.scrollTop()+c.outerHeight()+c.position().top-a.height()):c.position().top<0&&a.scrollTop(a.scrollTop()+c.position().top)},nextOption:function(){m<g.options.length-1&&(g.selectedItem=g.options[++m],g.scrollIntoView())},prevOption:function(){m>0&&(g.selectedItem=g.options[--m],g.scrollIntoView())},keypress:function(a){40===a.keyCode?(g.open(),g.nextOption()):38===a.keyCode?(g.open(),g.prevOption()):13===a.keyCode?g.toggle():j.search&&/^[a-z0-9]+$/i.test(String.fromCharCode(a.keyCode))&&a.target!==h.get(0)&&(g.open(),d(function(){h.focus(),g.search=String.fromCharCode(a.keyCode).toLowerCase()},15))}},a.$watch("select.search",function(a){g.options=c("filter")(k,a);var b=g.options.indexOf(g.selectedItem);b>-1?(g.selectedItem=g.options[m=b],g.show&&d(function(){g.scrollIntoView()},10)):g.selectedItem=g.options[m=0]}),f&&(f.$render=function(){g.selectedItem=f.$viewValue},a.$watch("select.selectedItem",function(a){f.$setViewValue(a)})),h=b.find(".cb-select-search>input"),i=b.find(".cb-select-option"),b.on("click",".cb-select-value",function(){b.trigger("focus")}),b.on("focusout",function(b){(h.length>0?b.relatedTarget===h.get(0):0)||a.$apply(function(){g.focused=!1,g.close()})}),h.on("focusout",function(){a.$apply(function(){g.focused=!1,g.close()})}),b.on("keydown",function(b){[38,40].indexOf(b.keyCode)>0&&b.preventDefault(),a.$apply(function(){g.keypress(b)})})}}}}}]),angular.module("cbSlider",[]).directive("cbSlider",["$timeout",function(a){return{restrict:"A",scope:!0,require:"ngModel",link:function(b,c,d,e){var f,g,h,i,j,k=null;g={defaultPage:0,perPage:1,collectionName:"pages",autoPlay:!1,initialDelay:7e3,delay:5e3,delayFlux:1e3},angular.extend(g,b.$eval(d.cbSlider)),i=b.slider={lastPage:null,left:null,currentPage:g.defaultPage,perPage:g.perPage,onPage:function(a){return a===i.currentPage},next:function(){h(),i.currentPage<i.lastPage&&(i.left=!0,i.currentPage++)},prev:function(){h(),i.currentPage>0&&(i.left=!1,i.currentPage--)},"goto":function(a){h(),a>=0&&a<=i.lastPage&&(i.left=i.currentPage<a?!0:!1,i.currentPage=a)}},e.$render=function(){var a=e.$modelValue;if(angular.isDefined(a)){if(i.lastPage=Math.ceil(a.length/g.perPage)-1,i.currentPage>i.lastPage&&(i.currentPage=i.lastPage),1===g.perPage)j=a;else{j=[];for(var b=0,c=a.length;c>b;b+=g.perPage)j.push(a.slice(b,b+g.perPage))}i[g.collectionName]=j}else i[g.collectionName]=null},f=function(){var b=(i.currentPage+1)%(i.lastPage+1);i.left=!0,i.currentPage=b,k=a(f,g.delay+Math.random()*g.delayFlux)},h=g.autoPlay?function(){null!==k&&(a.cancel(k),k=a(f,g.initialDelay))}:angular.noop,g.autoPlay===!0&&(k=a(f,g.initialDelay))}}}]),angular.module("cbTooltip",[]).directive("cbTooltip",["$compile","$document","$sce",function(a,b,c){return{restrict:"A",scope:{title:"@title"},compile:function(){return{post:function(d,e,f){var g,h,i,j,k,l,m,n,o;g={tpl:'<div class="cb-tooltip" ng-style="style" ng-show="show"><header ng-if="title">{{title}}</header><section ng-bind-html="content"></section></div>',tplArrow:'<div class="arrow" ng-style="arrowStyle"></div>',position:"top",space:8,content:":)"},h=d,angular.extend(g,d.$eval(f.cbTooltip)),h.position=g.position,h.space=g.space,h.tpl=g.tpl,h.show=!1,h.tplArrow=g.tplArrow,h.content=c.trustAsHtml(f.content),l=angular.element(h.tpl),m=angular.element(h.tplArrow),n=a(l)(d),o=a(m)(d),e.addClass("cb-tooltip-active"),n.append(o),n.addClass(h.position),b.find("body").append(n),i=h.show=function(){h.$apply(function(){h.show=!0}),k()},j=h.hide=function(){h.$apply(function(){h.show=!1})},k=function(){var a=e.offset(),b=e.outerWidth(!0),c=e.outerHeight(!0),d=n.outerWidth(!0),f=n.outerHeight(!0),g=o.outerWidth(!0),i=o.outerHeight(!0),j=0,k=0,l={};"top"===h.position?(j=a.top-f-h.space,l.left=d/2-g/2):"bottom"===h.position?(j=a.top+c+h.space,l.left=d/2-g/2):"left"===h.position?(k=a.left-d-h.space,l.top=f/2-i/2):"right"===h.position&&(k=a.left+b+h.space,l.top=f/2-i/2),("top"===h.position||"bottom"===h.position)&&(k=d>b?a.left-(d-b)/2:a.left+(b-d)/2),("left"===h.position||"right"===h.position)&&(j=f>c?a.top-(f-c)/2:a.top+(c-f)/2),h.$apply(function(){h.style={top:j,left:k},h.arrowStyle=l})},e.on("mouseenter",i),e.on("mouseleave",j),d.$on("$destroy",function(){n.remove()})}}}}}])}();